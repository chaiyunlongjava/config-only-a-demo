
select rg.regi_name s0,
(
select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '010000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s1,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '010209000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s2,
(select count(t2.criminal_bewrite) as crimCount from(
select * from SYS_ZZ_ZDRKFL t where t.code like '01%' and t.code not in('010000000000','010209000000'))t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s3,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '350000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s4,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '350100000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s5,
(select count(t2.criminal_bewrite) as crimCount from(
select * from SYS_ZZ_ZDRKFL t where t.code like '35%' and t.code not in('350000000000','350100000000'))t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s6,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '030000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s7,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '040000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s8,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '040100000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s9,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '040200000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s10,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '050000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s11,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '050100000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s12,
(select count(t2.criminal_bewrite) as crimCount from(
select * from SYS_ZZ_ZDRKFL t where t.code like '05%' and t.code not in('050000000000','050100000000'))t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s13,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '060000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s14,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '060200000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s15,
(select count(t2.criminal_bewrite) as crimCount from(
select * from SYS_ZZ_ZDRKFL t where t.code like '06%' and t.code not in('060000000000','060200000000'))t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s16,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '070000000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s17,
(select count(t2.criminal_bewrite) as crimCount from(select * from SYS_ZZ_ZDRKFL t where t.code = '070200000000')t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s18,
(select count(t2.criminal_bewrite) as crimCount from(
select * from SYS_ZZ_ZDRKFL t where t.code like '07%' and t.code not in('070000000000','070200000000'))t1
left join (
select cr.criminal_bewrite,dw.area_code from SH_CRIMINAL_RECORD cr,
pt_renyuan ry,pt_renyuan_relation yr, pt_danwei dw
where ry.ry_id = yr.table_id
and cr.user_id = ry.ry_id
and yr.comp_id = dw.dw_id
and dw.area_code like '61%'
and yr.yw_lx in ('YB', 'JD', 'XJ', 'QJ', 'YH', 'MB', 'PT', 'SZ')
)t2 on t1.code = t2.criminal_bewrite 
where rg.regi_id = substr(t2.area_code, 1, 4) || substr('000000000000', 1, 12 - 4)
)as s19,
rg.regi_id as s20

from sys_regionalism rg where rg.regi_id like '61%' and rg.rety_id='2' order by rg.regi_id


